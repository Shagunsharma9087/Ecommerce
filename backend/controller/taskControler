const mongoose = require("mongoose");
const OrderModel=require('../Models/orders');
const ProductModel = require("../Models/product");
const CustomerInfoModel = require("../Models/customerinfo");
const  getOneType=async(req,res)=>{
    const {type}=req.body;
    try{
        const task=await ProductModel.find({type:type});
        res.status(200).json(task);
    }
    catch(error)
    {
        res.status(400).json({error:error.message})
    }
}
const getallproduct=async (req,res)=>{
    const {title}=req.body;
    try {
        console.log("hello")
        const task = await ProductModel.find({});
        res.status(200).json(task);
      } catch (error) {
        res.status(400).json({ error: error.message });
      }
}
const productadd= async(req,res)=>{
    const {title,type,description,price,rating} = req.body;
    try{
       const task= await ProductModel.create({title,type,description,price,rating})
        res.status(200).json(task);
    }
    catch(error)
    {
        res.status(400).json({ error: error.message });
    }
}
const login=async (req,res)=>{
    const {email,password}=req.body;
    console.log(req.body);
    try{
        const user= await CustomerInfoModel.findOne({email:email})
        if(user)
        {
            if(user.password===password)
            {
                res.json(user)
            }
            else
            {
                res.json("Incorrect Password")
            }
        }
        else{
            res.json("user not exist")
        }
    }
    catch(error)
    {
        res.status(400).json({ error: error.message });
    }
}
const register= async (req,res)=>{
    const { email,username ,password } = req.body;
    try{
       const task= await CustomerInfoModel.create({email,username:username,password})
        res.status(200).json(task);
    }
    catch(error)
    {
        res.status(400).json({ error: error.message });
    }

}
module.exports = {register,login,productadd,getallproduct,getOneType};